<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>C&#43;&#43; Functors en lambdafuncties</title>

  <meta name="author" content="" />
  
  

  <meta name="generator" content="Hugo 0.54.0" />

  <link rel="alternate" href="http://eaict.technologiecampusdiepenbeek.be/index.xml" type="application/rss+xml" title="eaict">

  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="http://eaict.technologiecampusdiepenbeek.be/css/bootstrap.min.css" />
  <link rel="stylesheet" href="http://eaict.technologiecampusdiepenbeek.be/css/main.css" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="http://eaict.technologiecampusdiepenbeek.be/css/pygment_highlights.css" />
  
  
  <meta property="og:title" content="C&#43;&#43; Functors en lambdafuncties" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/post/cpp-functor//" />
  <meta property="og:image" content="" />
  
</head>


  <body>
    <h1>een lange titel</h1>
    
    
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://eaict.technologiecampusdiepenbeek.be/">eaict</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
          <li>
          <a title="Start" href="/">Start</a>
  	      </li>
  	    
      
        
          <li>
          <a title="Over" href="/page/over/">Over</a>
  	      </li>
  	    
      
      </ul>
    </div>

	<div class="avatar-container">
	  <div class="avatar-img-border">
      
	  </div>
	</div>

  </div>
</nav>


    <div role="main" class="container main-content">

      
        





<header class="header-section ">

<div class="intro-header no-img">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <h1>C&#43;&#43; Functors en lambdafuncties</h1>
      
      
      
      <span class="post-meta">Gepost op 28-11-2017</span>
      
        </div>
      </div>
    </div>
  </div>
</div>
</header>




<div class="container">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
          <p>Dit artikel legt uit hoe je de capture bij lambdafuncties moet begrijpen.</p>

<p>Zoals gewone functies kunnen lambdafuncties ook parameters krijgen. Dit
de gangbare techniek om data naar een functie te kopiëren.</p>

<p>Bij lambdafuncties is er nog een extramechanisme en dat is de <em>capture</em>.
Zoals het woord het zegt, kan een capture de stand van een aantal externe variabelen
bevroren worden. Met extern wordt hier de lokale variabelen en parameters die buiten de
lambdafunctie bestaan. De waarde van deze externe variabelen wordt vastgelegd voor gebruik binnen
de lambdafunctie. Ook al worden de externe variabelen later gewijzigd, toch behouden ze hun waarde die ze
hadden tijdens het vastleggen van de lambdafunctie. Om dit proces duidelijk te maken is een stap terug nodig.</p>

<p>We leggen dit uit met een <em>functorklasse</em>. Dit is een klasse met naast de constructor slechts één methode, namelijk
<code>operator()</code>. Hierdoor kan een object van deze klassen als een functie gebruikt worden. Dit type object wordt <em>functieobject</em>
of <em>functor</em> genoemd.</p>

<p>Dit is de klasse:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#8f5902;font-style:italic">// functorklasse
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">class</span><span style="color:#a40000"> </span><span style="color:#000">xyz12345</span>
<span style="color:#000;font-weight:bold">{</span>
<span style="color:#204a87;font-weight:bold">private</span><span style="color:#ce5c00;font-weight:bold">:</span>
   <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">public</span><span style="color:#ce5c00;font-weight:bold">:</span>
   <span style="color:#000">xyz12345</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">yy</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">yy</span><span style="color:#000;font-weight:bold">)</span>
   <span style="color:#000;font-weight:bold">{</span>
   <span style="color:#000;font-weight:bold">}</span>
	
   <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#204a87;font-weight:bold">operator</span><span style="color:#000;font-weight:bold">()(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">p</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">s</span><span style="color:#000;font-weight:bold">)</span>
   <span style="color:#000;font-weight:bold">{</span>
      <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">p</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">s</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">;</span>
   <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">};</span>
</code></pre></div>
<p>Deze klasse is niet speciaal; er is een datamember <code>y</code> zodat in objecten van deze klasse één <code>int</code>
opgeslagen worden. Deze opslag doet dienst als capture. Met de constructor kan een waarde in deze <code>y</code>
opgeslagen worden. De <code>operator()</code> krijgt het adres van een <code>int</code><sup class="footnote-ref" id="fnref:1"><a href="#fn:1">1</a></sup> en nog een <code>int</code> en maakt de som
van 3 waarden.</p>

<p>Dan maken we eerst een functorobject.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">w</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">xyz12345</span> <span style="color:#000">obj</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">w</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#ce5c00;font-weight:bold">~~~~</span>
</code></pre></div>
<p>In het object <code>obj</code> wordt de waarde <code>5</code> opgeslagen. Eigenlijk doet <code>obj</code> een opslag (<em>capture</em>) van de momentele waarde van
<code>w</code>. De opgeslagen waarde is <code>5</code>. <code>w</code> mag achteraf nog gewijzigd worden; dit heeft geen invloed op de <code>5</code> die nu al in <code>obj</code>
opgeslagen is.</p>

<p>In het volgende fragment wordt de functie van het functieobject opgeroepen. Hierbij worden twee parameters meegegeven.
De eerste waarde is <code>7</code> en de tweede is <code>3</code>. Intern wordt de som <code>7+3+5</code> berekend en als resultaat teruggegeven.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">s9</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">s9</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">obj</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">s9</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;s9 &#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">s9</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">;</span>
</code></pre></div>
<p>Het volgende fragment doet identiek hetzelfde maar nu met een lambdafunctie.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">la</span> <span style="color:#ce5c00;font-weight:bold">=</span>
<span style="color:#000;font-weight:bold">[</span><span style="color:#000">w</span><span style="color:#000;font-weight:bold">](</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">p</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">s</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
   <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">p</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">s</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">w</span><span style="color:#000;font-weight:bold">;</span> 
<span style="color:#000;font-weight:bold">};</span>
<span style="color:#000">s9</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">la</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">s9</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div>
<p>Het voordeel van de lambdafunctie is dat er een syntax met <code>[]</code> bestaat voor het vastleggen van de capture.
Deze syntax is nieuw sinds C++11 en zal meer en meer opduiken in situaties zoals eventafhandeling in Qt.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">Waarom dit een pointer naar <code>int</code> is en geen <code>int</code> doet hier niet terzake.
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
</ol>
</div>
      </article>

      <ul class="pager blog-pager">
        
        <li class="previous">
          <a href="http://eaict.technologiecampusdiepenbeek.be/post/erlang-nodes-in-docker/" data-toggle="tooltip" data-placement="top" title="Erlang nodes in Docker">&larr; Vorige post</a>
        </li>
        
        
        <li class="next">
          <a href="http://eaict.technologiecampusdiepenbeek.be/post/cpp-som/" data-toggle="tooltip" data-placement="top" title="De som van een reeks in C&#43;&#43;">Volgende post &rarr;</a>
        </li>
        
      </ul>

      

    </div>
  </div>
</div>

      

    </div>

    <footer>
  <div class="container beautiful-jekyll-footer">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
		      
		      
		      
	    	  
          
          

    		  <li>
      			<a href="http://eaict.technologiecampusdiepenbeek.be/index.xml" title="RSS">
      			  <span class="fa-stack fa-lg">
        				<i class="fa fa-circle fa-stack-2x"></i>
        				<i class="fa fa-rss fa-stack-1x fa-inverse"></i>
      			  </span>
      			</a>
    		  </li>		

        </ul>
        <p class="copyright text-muted">
    		  
    		  &nbsp;&bull;&nbsp;
    		  2017
    		  
    		  
    		  &nbsp;&bull;&nbsp;
    		  <a href="http://eaict.technologiecampusdiepenbeek.be/">eaict</a>
    		  
  	    </p>
  	        
    		<p class="theme-by text-muted">
    		  Theme by
    		  <a href="http://deanattali.com/beautiful-jekyll/">beautiful-jekyll</a>
    		</p>
      </div>
    </div>
  </div>
</footer>

<script src="http://eaict.technologiecampusdiepenbeek.be/js/jquery-1.11.2.min.js"></script>
<script src="http://eaict.technologiecampusdiepenbeek.be/js/bootstrap.min.js"></script>
<script src="http://eaict.technologiecampusdiepenbeek.be/js/main.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-92842352-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


  </body>
</html>
